% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/geom_recession.r
\name{geom_recession}
\alias{geom_recession}
\title{Add recession shading to ggplot2 charts}
\usage{
geom_recession(
  data = NULL,
  api_key = NULL,
  start_year = NULL,
  end_year = NULL,
  peak_col = "peak",
  trough_col = "trough",
  period_col = "periodyear",
  fill = "gray",
  alpha = 0.3
)
}
\arguments{
\item{data}{A data frame containing recession data with peak, trough, and period
columns. If `NULL` (default), recession data will be automatically fetched
from FRED using `make_recession_table()`.}

\item{api_key}{Character string. FRED API key for accessing recession data when
`data = NULL`. If not provided, the function will look for the key in the
`FRED_API_KEY` environment variable.}

\item{start_year}{Numeric. The earliest year for which to show recessions.
This parameter is required and filters the recession data to only include
recessions that began in or after this year.}

\item{end_year}{Numeric. Optional. The latest year for which to show recessions.
If provided, filters recession data to only include recessions that began
in or before this year.}

\item{peak_col}{Character string. Name of the column containing recession peak
(start) dates. Default is "peak".}

\item{trough_col}{Character string. Name of the column containing recession trough
(end) dates. Default is "trough".}

\item{period_col}{Character string. Name of the column containing the recession
period year. Default is "periodyear".}

\item{fill}{Character string. Fill color for recession shading. Default is "gray".}

\item{alpha}{Numeric. Transparency level for recession shading, between 0 and 1.
Default is 0.3.}
}
\value{
A ggplot2 layer (geom_rect) that can be added to a ggplot object.
}
\description{
This function adds shaded rectangular areas to indicate US recession periods
on time series charts. It automatically fetches recession data from FRED or
accepts user-provided recession data.
}
\details{
The function creates rectangular shaded areas spanning from ymin = -Inf
  to ymax = Inf, automatically adapting to any y-axis scale. Recession periods
  are filtered based on the `start_year` parameter to show only relevant recessions
  for the time period being plotted.

  When `data = NULL`, the function calls `make_recession_table()` to fetch current
  recession data from the Federal Reserve Economic Data (FRED) database.
}
\examples{
\dontrun{
library(ggplot2)
library(dplyr)

# Basic usage with automatic data fetching
economic_data \%>\%
  ggplot(aes(x = date, y = value)) +
  geom_line() +
  geom_recession(start_year = 2000)

# With custom styling
economic_data \%>\%
  ggplot(aes(x = date, y = value)) +
  geom_line() +
  geom_recession(start_year = 2007, fill = "red", alpha = 0.1)

# Using date range from your data
min_year <- year(min(economic_data$date))
economic_data \%>\%
  ggplot(aes(x = date, y = value)) +
  geom_line() +
  geom_recession(start_year = min_year)

# With both start and end years
economic_data \%>\%
  ggplot(aes(x = date, y = value)) +
  geom_line() +
  geom_recession(start_year = 2000, end_year = 2020)

# Using your own recession data
recession_data <- make_recession_table()
economic_data \%>\%
  ggplot(aes(x = date, y = value)) +
  geom_line() +
  geom_recession(data = recession_data, start_year = 2007)

# Works with any type of plot
economic_data \%>\%
  filter(date > "2007-07-31") \%>\%
  ggplot() +
  geom_recession(start_year = 2007) +
  geom_col(aes(x = date, y = change)) +
  scale_y_continuous(labels = scales::percent)
}

}
\seealso{
\code{\link{make_recession_table}} for fetching recession data

\code{\link[ggplot2]{geom_rect}} for the underlying geom
}
